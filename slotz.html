<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Slotz</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --dark-bg: #0a0a0a;
      --darker-bg: #070707;
      --light-text: #f0f0f0;
      --accent-color: #f0f0f0;
    }
    * {
      box-sizing: border-box;
      margin: 0; padding: 0;
      font-family: 'Roboto Mono', monospace;
      font-weight: 500;
      color: var(--light-text);
    }
    body {
      margin: 0;
      background: var(--dark-bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      overflow-x: hidden;
    }
    /* Navbar */
    .navbar-container { width:100%; flex-shrink:0; }
    .navbar {
      background: var(--darker-bg);
      padding:0.75rem 1.5rem;
      display:flex; justify-content:space-between; align-items:center;
      border-bottom:2px solid var(--accent-color);
    }
    .logo { font-size:1.5rem; }
    .nav-buttons { display:flex; gap:1rem; }
    .btn {
      padding:0.5rem 1rem; border-radius:50px;
      background:transparent; border:2px solid var(--accent-color);
      cursor:pointer; text-decoration:none;
      transition:background 0.2s;
    }
    .btn:hover { background:rgba(255,255,255,0.1); }

    /* Slot Machine */
    h1 {
      margin:2rem 0 1rem;
      font-size:2rem; letter-spacing:2px;
      animation: glow 2s infinite;
    }
    #controls {
      display:flex; gap:1rem; align-items:center;
      margin-bottom:1.5rem;
    }
    input, button {
      background:transparent;
      border:2px solid var(--accent-color);
      padding:0.4rem 0.8rem;
      border-radius:8px;
      font-family:inherit; font-size:1rem;
      color:var(--light-text);
    }
    input { width:80px; text-align:center; }
    button { position:relative; overflow:hidden; }
    button:after {
      content:''; position:absolute; top:-50%; left:-50%;
      width:200%; height:200%;
      background:radial-gradient(circle at center, rgba(255,255,255,0.2),transparent 70%);
      transform:rotate(45deg) translate(-100%,-100%);
      opacity:0; transition:opacity 0.3s,transform 0.5s;
    }
    button:active:after {
      opacity:1; transform:rotate(45deg) translate(0,0); transition:none;
    }

    #slot-machine {
      display:flex; gap:1rem; margin-bottom:1rem;
    }
    .reel {
      width:80px; height:80px;
      border:3px solid var(--accent-color);
      border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      overflow:hidden; position:relative;
      animation: blink 1.5s infinite;
    }
    .number {
      position:absolute; font-size:2.5rem;
    }
    .reel.spinning .number {
      animation: slide 0.4s linear infinite;
      filter:blur(4px);
    }

    #message {
      height:1.5em; margin-bottom:2rem;
      font-size:1.1rem; opacity:0;
      transition:opacity 0.5s;
    }
    #message.win { animation: glow 1s infinite; opacity:1; }
    #message.win.x2 { color:#0f0; }
    #message.win.x3 { color:#ff0; }
    #message.lose { color:#f00; opacity:1; }

    .confetti {
      position:fixed; width:6px; height:6px;
      background:var(--accent-color);
      top:0; opacity:0.8; pointer-events:none;
      animation:fall 2s ease-out forwards;
    }

    @keyframes slide {
      0%  { transform:translateY(100%); }
      100%{ transform:translateY(-100%); }
    }
    @keyframes blink {
      0%,100%{ border-color:var(--accent-color); }
      50%    { border-color:#777; }
    }
    @keyframes glow {
      0%,100%{ text-shadow:0 0 5px var(--accent-color); }
      50%    { text-shadow:0 0 20px var(--accent-color); }
    }
    @keyframes fall {
      to {
        transform:translate(var(--dx),100vh) rotate(var(--rot));
        opacity:0;
      }
    }
  </style>
</head>
<body>

  <div class="navbar-container">
    <nav class="navbar">
      <div class="logo">Slotz</div>
      <div class="nav-buttons">
        <a href="dashboard.html" class="btn">Dashboard</a>
        <button class="btn" id="logoutBtn">Logout</button>
      </div>
    </nav>
  </div>

  <h1>Slotz</h1>

  <div id="controls">
    <div>Balance:Â <span id="balance">1000</span></div>
    <div>Bet:Â <input type="number" id="bet" min="1" step="1" value="10"/></div>
    <button id="spin">SPIN</button>
  </div>

  <div id="slot-machine">
    <div class="reel"><div class="number">0</div></div>
    <div class="reel"><div class="number">0</div></div>
    <div class="reel"><div class="number">0</div></div>
  </div>

  <div id="message"></div>

  <script>
    // ===== Reel strips (weights) just like physical reels =====
    // Each symbol appears multiple times â†’ controls its probability.
    const strip = [
      ...Array(30).fill(1),
      ...Array(25).fill(2),
      ...Array(20).fill(3),
      ...Array(15).fill(4),
      ...Array(7).fill(5),
      ...Array(2).fill(6),
      ...Array(1).fill(7)
    ];
    // shuffle once for each reel
    const reelsData = [ shuffle(strip), shuffle(strip), shuffle(strip) ];

    function shuffle(arr) {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // pick a random symbol from a given reel strip
    function spinReelValue(reel) {
      const idx = Math.floor(Math.random() * reel.length);
      return reel[idx];
    }

    // ===== UI & Logic =====
    const reelsEls = document.querySelectorAll('.reel .number');
    const spinBtn = document.getElementById('spin');
    const balEl = document.getElementById('balance');
    const betEl = document.getElementById('bet');
    const msgEl = document.getElementById('message');
    const logoutBtn = document.getElementById('logoutBtn');
    let balance = 1000;

    logoutBtn.addEventListener('click', () => location.href = 'login.html');
    function updateBalance() { balEl.textContent = balance; }

    function animateReel(el, duration, final) {
      const parent = el.parentElement;
      parent.classList.add('spinning');
      return new Promise(res => {
        setTimeout(() => {
          parent.classList.remove('spinning');
          el.textContent = final;
          res(final);
        }, duration);
      });
    }

    function burstConfetti(){
      for(let i=0;i<30;i++){
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = (Math.random()*100)+'vw';
        c.style.setProperty('--dx', ((Math.random()*2-1)*100)+'vw');
        c.style.setProperty('--rot', (Math.random()*360)+'deg');
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 2000);
      }
    }

    spinBtn.addEventListener('click', async () => {
      const bet = Number(betEl.value);
      // only whole numbers, â‰¥1 and â‰¤balance
      if (!Number.isInteger(bet) || bet < 1 || bet > balance) {
        return alert('Please enter a wholeâ€‘number bet betweenÂ 1 and your balance.');
      }
      // lock controls
      spinBtn.disabled = betEl.disabled = true;

      balance -= bet;
      updateBalance();
      msgEl.textContent = '';
      msgEl.className = '';

      // spin each reel with staggered timing
      const durations = [1200, 1400, 1600].map(d => d + Math.random()*300);
      // pick final symbols from weighted strips
      const finals = reelsData.map((strip, i) => spinReelValue(strip));
      const results = await Promise.all(finals.map((val, i) =>
        animateReel(reelsEls[i], durations[i], val)
      ));

      // count matches
      const counts = {};
      results.forEach(n => counts[n] = (counts[n]||0) + 1);

      // determine payout: 3Ã— for any triple, 2Ã— for any pair
      let payout = 0, cls = '';
      if (Object.values(counts).includes(3)) {
        payout = bet * 3;
        msgEl.textContent = 'ðŸŽ‰ JACKPOT! 3Ã— WIN!';
        cls = 'x3';
      } else if (Object.values(counts).includes(2)) {
        payout = bet * 2;
        msgEl.textContent = 'âœ¨ Nice! 2Ã— WIN!';
        cls = 'x2';
      } else {
        msgEl.textContent = 'ðŸ˜¢ You lose';
        msgEl.className = 'lose';
      }

      if (payout > 0) {
        msgEl.className = `win ${cls}`;
        burstConfetti();
      }
      balance += payout;
      updateBalance();

      // unlock
      spinBtn.disabled = betEl.disabled = false;
    });

    updateBalance();
  </script>
</body>
</html>