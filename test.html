<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>4SP | Interstellar</title>
  <style>
    html, body, iframe {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      border: none;
    }
    iframe {
      display: block;
    }
    #keyboard-trap {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <!-- Hidden overlay to capture keystrokes -->
  <div id="keyboard-trap" tabindex="-1"></div>
  
  <iframe id="content-frame" src="https://4sp.global.ssl.fastly.net/" allowfullscreen></iframe>
  
  <script>
    // The main issue is that we need to capture keyboard events
    // without interfering with normal typing in the iframe
    
    // Our keyboard trap div
    const keyboardTrap = document.getElementById('keyboard-trap');
    
    // Setup the global shortcut listener on the trap element
    keyboardTrap.addEventListener('keydown', function(event) {
      if (event.ctrlKey && event.shiftKey && event.key.toLowerCase() === 'x') {
        window.location.href = 'dashboard.html';
        event.preventDefault();
      }
    });
    
    // Cross-browser solution that uses postMessage
    // This allows communication between iframe and parent even across domains
    window.addEventListener('message', function(event) {
      // Optional: Check origin for security
      // if (event.origin !== 'https://expected-origin.com') return;
      
      const data = event.data;
      if (data && data.type === 'keyEvent' && 
          data.ctrlKey && data.shiftKey && data.key.toLowerCase() === 'x') {
        window.location.href = 'dashboard.html';
      }
    });
    
    // For cases where we can inject code into the iframe
    const iframe = document.getElementById('content-frame');
    iframe.addEventListener('load', function() {
      try {
        // Try to access the iframe content (works only for same-origin)
        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        
        // Create and inject a script element into the iframe
        const script = iframeDoc.createElement('script');
        script.textContent = `
          document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.shiftKey && event.key.toLowerCase() === 'x') {
              // Send message to parent window
              window.parent.postMessage({
                type: 'keyEvent',
                ctrlKey: event.ctrlKey,
                shiftKey: event.shiftKey,
                key: event.key
              }, '*');
              
              // Prevent default behavior in iframe
              event.preventDefault();
              event.stopPropagation();
            }
          }, true);
        `;
        iframeDoc.head.appendChild(script);
      } catch (e) {
        console.log('Cannot inject script into iframe (likely cross-origin): ', e);
        
        // Alternative approach for cross-origin iframes:
        // Use the global keydown event but don't steal focus
        window.addEventListener('keydown', function(event) {
          if (event.ctrlKey && event.shiftKey && event.key.toLowerCase() === 'x') {
            window.location.href = 'dashboard.html';
          }
        }, true);
      }
    });
  </script>
</body>
</html>
