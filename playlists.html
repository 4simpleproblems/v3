<!-- playlists.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4SP | Your Playlists</title>
  <link rel="stylesheet" href="styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="firebase-config.js"></script>
  <style>
    body { background:#121212; color:#fff; font-family:'Roboto Mono', monospace; margin:0; display:flex; flex-direction:column; min-height:100vh; }
    .navbar { background:#1e1e1e; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; }
    .navbar .logo { color:#fff; font-size:1.5rem; font-weight:bold; }
    .navbar .btn { color:#fff; border:2px solid #fff; padding:0.5rem 1rem; border-radius:30px; text-decoration:none; transition:background 0.2s; }
    .navbar .btn:hover { background:rgba(255,255,255,0.1); }
    main { flex:1; max-width:1000px; margin:2rem auto; padding:0 1rem; }
    .controls { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; }
    .controls h1 { margin:0; }
    .controls .btn { font-size:1rem; }
    .dashboard-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:1rem; }
    .dashboard-tile { background:#2a2a2a; padding:1rem; border-radius:20px; text-decoration:none; color:#fff; display:flex; flex-direction:column; justify-content:center; min-height:120px; transition:transform 0.2s; position:relative; }
    .dashboard-tile:hover { transform:translateY(-5px); }
    .badge { font-size:0.75rem; background:#444; padding:0.2rem 0.5rem; border-radius:10px; margin-top:0.5rem; display:inline-block; }
    /* small text fit */
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="logo">4SP</div>
    <a href="#" id="logoutBtn" class="btn">Log Out</a>
  </nav>
  <main>
    <div class="controls">
      <h1>Your Playlists</h1>
      <a href="playlist-create.html" class="btn">+ Create Playlist</a>
    </div>
    <div id="playlistGrid" class="dashboard-grid"></div>
  </main>
  <script>
    // Initialize auth and UI
    function initAuth() {
      const auth = firebase.auth();
      document.getElementById('logoutBtn').addEventListener('click',e=>{e.preventDefault();auth.signOut();});
      auth.onAuthStateChanged(user=>{if(user){ loadPlaylists(user.uid);} else { window.location='index.html'; }});
    }
    // Load Firestore + localStorage playlists
    function loadPlaylists(uid){
      const grid = document.getElementById('playlistGrid'); grid.innerHTML='';
      const db = firebase.firestore();
      // Firestore playlists
      db.collection('users').doc(uid).collection('playlists').get().then(snap=>{
        snap.forEach(doc=>{
          const p=doc.data(); grid.appendChild(makeTile(p.name,p.description,'normal','playlist-show.html?id='+doc.id));
        });
      });
      // Local playlists
      const local = JSON.parse(localStorage.getItem('localPlaylists')||'[]');
      local.forEach(p=>{ grid.appendChild(makeTile(p.name,p.description,'local','playlist-show.html?local='+p.id)); });
    }
    function makeTile(name,desc,type,href){
      const a=document.createElement('a'); a.href=href; a.className='dashboard-tile';
      const h3=document.createElement('h3'); h3.textContent=name; a.appendChild(h3);
      const p=document.createElement('p'); p.textContent=desc; a.appendChild(p);
      const b=document.createElement('span'); b.textContent=type==='local'?'Local':'Normal'; b.className='badge'; a.appendChild(b);
      return a;
    }
    document.addEventListener('DOMContentLoaded',initAuth);
  </script>
</body>
</html>
